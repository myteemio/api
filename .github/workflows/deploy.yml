name: Deploy to TeemioAPI
on:
  push:

jobs:
  test:
    name: test
    runs-on: ubuntu-latest
    env:
      DB_CONNECTION_STRING: ${{ secrets.DB_CONNECTION_STRING }}
      JWT_SECRET: ${{ secrets.JWT_SECRET }}
      RESEND_API_KEY: ${{ secrets.RESEND_API_KEY }}
      NODE_ENV: ${{ secrets.NODE_ENV }}
    steps:
      - uses: actions/checkout@v3
      - uses: oven-sh/setup-bun@v1
      - name: Install dependencies
        run: bun install

      - name: Clear MongoDB Cache
        run: rm -rf /home/runner/.cache/mongodb-binaries

      - name: Wait for a few seconds
        run: sleep 10

      - name: Run Tests
        run: bun test